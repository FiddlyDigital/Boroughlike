<!DOCTYPE html>
<title>Boroughlike</title>

<head>
    <style>
        canvas {
            outline: 1px solid white;
        }

        body {
            background-color: indigo;
            text-align: center;
            margin-top: 50px;
        }
    </style>
</head>

<body>
    <canvas></canvas>

    <script src="js/game.js"></script>
    <script src="js/map.js"></script>
    <script src="js/monster.js"></script>
    <script src="js/soundPlayer.js"></script>
    <script src="js/spell.js"></script>
    <script src="js/tile.js"></script>
    <script src="js/utilities.js"></script>

    <script>
        tileSize = 64;
        numTiles = 12;
        uiWidth = 3;
        level = 1;
        maxHp = 6;

        spritesheet = new Image();
        spritesheet.src = 'spritesheet.png';
        spritesheet.onload = showTitle;

        gameState = GAMESTATES.LOADING;
        startingHp = 3;
        numLevels = 6;

        shakeAmount = 0;
        shakeX = 0;
        shakeY = 0;

        document.querySelector("html").onkeydown = function (e) {
            switch (gameState) {
                case GAMESTATES.TITLE:
                    startGame();
                    break;
                case GAMESTATES.GAMEOVER:
                    showTitle();
                    break;
                case GAMESTATES.RUNNING:
                    handleKeypress(e);
                    break;
            }
        };

        function handleKeypress(e) {
            e = e || window.event;
            if (e.defaultPrevented) {
                return; // Do nothing if the event was already processed
            }

            switch (e.key) {
                case "Up": case "ArrowUp":
                case "w": case "W":
                    player.tryMove(0, -1)
                    break;
                case "Down": case "ArrowDown":
                case "s": case "S":
                    player.tryMove(0, 1);
                    break;
                case "Left": case "ArrowLeft":
                case "a": case "A":
                    player.tryMove(-1, 0);
                    break;
                case "Right": case "ArrowRight":
                case "d": case "D":
                    player.tryMove(1, 0);
                    break;
                case 1: case "1":
                case 2: case "2":
                case 3: case "3":
                case 4: case "4":
                case 5: case "5":
                case 6: case "6":
                case 7: case "7":
                case 8: case "8":
                case 9: case "9":
                    player.castSpell(parseInt(e.key) - 1);
                    break;
            }
        }

        setInterval(draw, 15); // ever 15ms, or 60 fps
        setupCanvas();
        SOUNDPLAYER.initSounds();
    </script>
</body>

</html>